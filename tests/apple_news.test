<?php

/**
 * @file
 * Contains tests for the Apple News module.
 */

use ChapterThree\AppleNewsDoc;

/**
 * Base class for Apple News web tests.
 */
abstract class AppleNewsWebTestCase extends DrupalWebTestCase {

  protected $watchdogSeverityLevel = WATCHDOG_WARNING;

  /**
   * {@inheritdoc}
   */
  public function setUp(array $modules = array()) {
    parent::setUp(array_merge(array('apple_news', 'dblog'), $modules));
  }

  /**
   * {@inheritdoc}
   *
   * @see http://dcycleproject.org/blog/96/catching-watchdog-errors-your-simpletests
   */
  public function tearDown() {
    $query = db_select('watchdog')
      ->fields(NULL, array('wid'))
      ->condition('severity', $this->watchdogSeverityLevel, '<=')
      ->countQuery();
    $count = $query->execute()->fetchField();
    $this->assertTrue($count == 0, 'Found ' . $count . ' watchdog entries.');
    // Uncomment to debug watchdog table.
    // if (!count)
    parent::tearDown();
  }

}
